{"remainingRequest":"E:\\WorkSpace\\vue_mcake\\mcake\\node_modules\\babel-loader\\lib\\index.js!E:\\WorkSpace\\vue_mcake\\mcake\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\WorkSpace\\vue_mcake\\mcake\\src\\api\\http.js","dependencies":[{"path":"E:\\WorkSpace\\vue_mcake\\mcake\\src\\api\\http.js","mtime":1581942310720},{"path":"E:\\WorkSpace\\vue_mcake\\mcake\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\WorkSpace\\vue_mcake\\mcake\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\WorkSpace\\vue_mcake\\mcake\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwoKdmFyIF90aGlzID0gdGhpczsKCi8qKg0KICogYXhpb3PlsIHoo4UNCiAqIOivt+axguaLpuaIquOAgeWTjeW6lOaLpuaIquOAgemUmeivr+e7n+S4gOWkhOeQhg0KICovCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCByb3V0ZXIgZnJvbSAiLi4vcm91dGVyIjsKaW1wb3J0IHN0b3JlIGZyb20gIi4uL3N0b3JlL2luZGV4IjsKLyoqDQogKiDmj5DnpLrlh73mlbANCiAqLwoKdmFyIHRpcCA9IGZ1bmN0aW9uIHRpcChtc2cpIHsKICB2YXIgdHlwZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJ2luZm8nOwoKICBfdGhpcy4kbWVzc2FnZSh7CiAgICBtZXNzYWdlOiBtc2csCiAgICB0eXBlOiB0eXBlLAogICAgZHVyYXRpb246IDE1MDAKICB9KTsKfTsKLyoqDQogKiDot7PovaznmbvlvZXpobUNCiAqIOaQuuW4puW9k+WJjemhtemdoui3r+eUse+8jOS7peacn+WcqOeZu+W9lemhtemdouWujOaIkOeZu+W9leWQjui/lOWbnuW9k+WJjemhtemdog0KICovCgoKdmFyIHRvTG9naW4gPSBmdW5jdGlvbiB0b0xvZ2luKCkgewogIHJvdXRlci5yZXBsYWNlKHsKICAgIHBhdGg6ICcvbG9naW4nLAogICAgcXVlcnk6IHsKICAgICAgcmVkaXJlY3Q6IHJvdXRlci5jdXJyZW50Um91dGUuZnVsbFBhdGgKICAgIH0KICB9KTsKfTsKLyoqDQogKiDlkIzkuIDor7fmsYLlnLDlnYANCiAqLwoKCnZhciBCQVNFX1VSTCA9ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvJzsKLyoqDQogKiDor7fmsYLlpLHotKXlkI7nmoTplJnor6/nu5/kuIDlpITnkIYNCiAqIEBwYXJhbSB7TnVtYmVyfSBzdGF0dXMg6K+35rGC5aSx6LSl55qE54q25oCB56CBDQogKi8KCnZhciBlcnJvckhhbmRsZSA9IGZ1bmN0aW9uIGVycm9ySGFuZGxlKHN0YXR1cywgb3RoZXIpIHsKICAvLyDnirbmgIHnoIHliKTmlq0KICBzd2l0Y2ggKHN0YXR1cykgewogICAgLy8gNDAxOiDmnKrnmbvlvZXnirbmgIHvvIzot7PovaznmbvlvZXpobUKICAgIGNhc2UgNDAxOgogICAgICB0b0xvZ2luKCk7CiAgICAgIGJyZWFrOwogICAgLy8gNDAzIHRva2Vu6L+H5pyfCiAgICAvLyDmuIXpmaR0b2tlbuW5tui3s+i9rOeZu+W9lemhtQoKICAgIGNhc2UgNDAzOgogICAgICB0aXAoJ+eZu+W9lei/h+acn++8jOivt+mHjeaWsOeZu+W9lScpOwogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXInKTsgLy8gc3RvcmUuY29tbWl0KCdsb2dvdXQnLCBmYWxzZSk7CgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB0b0xvZ2luKCk7CiAgICAgIH0sIDEwMDApOwogICAgICBicmVhazsKICAgIC8vIDQwNOivt+axguS4jeWtmOWcqAoKICAgIGNhc2UgNDA0OgogICAgICB0aXAoJ+ivt+axgueahOi1hOa6kOS4jeWtmOWcqCcsICdlcnJvcicpOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgICBjb25zb2xlLmxvZyhvdGhlcik7CiAgfQp9OyAvLyDliJvlu7pheGlvc+WunuS+iwoKCnZhciBpbnN0YW5jZSA9IGF4aW9zLmNyZWF0ZSh7CiAgYmFzZVVSTDogQkFTRV9VUkwsCiAgdGltZW91dDogMTAwMCAqIDEyCn0pOyAvLyDorr7nva5wb3N06K+35rGC5aS0CgppbnN0YW5jZS5kZWZhdWx0cy5oZWFkZXJzLnBvc3RbJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCc7Ci8qKg0KICog6K+35rGC5oum5oiq5ZmoDQogKiDmr4/mrKHor7fmsYLliY3vvIzlpoLmnpzlrZjlnKh0b2tlbuWImeWcqOivt+axguWktOS4reaQuuW4pnRva2VuDQogKi8KCmluc3RhbmNlLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZShmdW5jdGlvbiAoY29uZmlnKSB7CiAgLy8g55m75b2V5rWB56iL5o6n5Yi25Lit77yM5qC55o2u5pys5Zyw5piv5ZCm5a2Y5ZyodG9rZW7liKTmlq3nlKjmiLfnmoTnmbvlvZXmg4XlhrUKICAvLyDkvYbmmK/ljbPkvb90b2tlbuWtmOWcqO+8jOS5n+acieWPr+iDvXRva2Vu5piv6L+H5pyf55qE77yM5omA5Lul5Zyo5q+P5qyh55qE6K+35rGC5aS05Lit5pC65bimdG9rZW4KICAvLyDlkI7lj7DmoLnmja7mkLrluKbnmoR0b2tlbuWIpOaWreeUqOaIt+eahOeZu+W9leaDheWGte+8jOW5tui/lOWbnue7meaIkeS7rOWvueW6lOeahOeKtuaAgeeggQogIC8vIOiAjOWQjuaIkeS7rOWPr+S7peWcqOWTjeW6lOaLpuaIquWZqOS4re+8jOagueaNrueKtuaAgeeggei/m+ihjOS4gOS6m+e7n+S4gOeahOaTjeS9nOOAggogIHZhciB0b2tlbiA9IHN0b3JlLnN0YXRlLnRva2VuOwogIHRva2VuICYmIChjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gdG9rZW4pOwogIHJldHVybiBjb25maWc7Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIHJldHVybiBQcm9taXNlLmVycm9yKGVycm9yKTsKfSk7IC8vIOWTjeW6lOaLpuaIquWZqAoKaW5zdGFuY2UuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZSggLy8g6K+35rGC5oiQ5YqfCmZ1bmN0aW9uIChyZXMpIHsKICByZXR1cm4gcmVzLnN0YXR1cyA9PT0gMjAwID8gUHJvbWlzZS5yZXNvbHZlKHJlcy5kYXRhKSA6IFByb21pc2UucmVqZWN0KHJlcy5kYXRhKTsKfSwgLy8g6K+35rGC5aSx6LSlCmZ1bmN0aW9uIChlcnJvcikgewogIHZhciByZXNwb25zZSA9IGVycm9yLnJlc3BvbnNlOwoKICBpZiAocmVzcG9uc2UpIHsKICAgIC8vIOivt+axguW3suWPkeWHuu+8jOS9huaYr+S4jeWcqDJ4eOeahOiMg+WbtAogICAgZXJyb3JIYW5kbGUocmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5kYXRhLm1lc3NhZ2UpOwogICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3BvbnNlKTsKICB9IGVsc2UgewogICAgLy8g5aSE55CG5pat572R55qE5oOF5Ya1CiAgICAvLyBlZzror7fmsYLotoXml7bmiJbmlq3nvZHml7bvvIzmm7TmlrBzdGF0ZeeahG5ldHdvcmvnirbmgIEKICAgIC8vIG5ldHdvcmvnirbmgIHlnKhhcHAudnVl5Lit5o6n5Yi2552A5LiA5Liq5YWo5bGA55qE5pat572R5o+Q56S657uE5Lu255qE5pi+56S66ZqQ6JePCiAgICAvLyDlhbPkuo7mlq3nvZHnu4Tku7bkuK3nmoTliLfmlrDph43mlrDojrflj5bmlbDmja7vvIzkvJrlnKjmlq3nvZHnu4Tku7bkuK3or7TmmI4KICAgIGlmICghd2luZG93Lm5hdmlnYXRvci5vbkxpbmUpIHsvLyBoNeS9v+eUqCBwY+W/veeVpQogICAgICAvLyBzdG9yZS5jb21taXQoJ2NoYW5nZU5ldHdvcmsnLCBmYWxzZSk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpOwogICAgfQogIH0KfSk7CmV4cG9ydCBkZWZhdWx0IGluc3RhbmNlOw=="},{"version":3,"sources":["E:/WorkSpace/vue_mcake/mcake/src/api/http.js"],"names":["axios","router","store","tip","msg","type","$message","message","duration","toLogin","replace","path","query","redirect","currentRoute","fullPath","BASE_URL","errorHandle","status","other","localStorage","removeItem","setTimeout","console","log","instance","create","baseURL","timeout","defaults","headers","post","interceptors","request","use","config","token","state","Authorization","error","Promise","response","res","resolve","data","reject","window","navigator","onLine"],"mappings":";;;;;;AAAA;;;;AAIA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP;AACA,OAAOC,KAAP;AAEA;;;;AAGA,IAAMC,GAAG,GAAG,SAANA,GAAM,CAACC,GAAD,EAAuB;AAAA,MAAlBC,IAAkB,uEAAX,MAAW;;AACjC,EAAA,KAAI,CAACC,QAAL,CAAc;AACZC,IAAAA,OAAO,EAAEH,GADG;AAEZC,IAAAA,IAAI,EAAEA,IAFM;AAGZG,IAAAA,QAAQ,EAAE;AAHE,GAAd;AAKD,CAND;AAQA;;;;;;AAIA,IAAMC,OAAO,GAAG,SAAVA,OAAU,GAAM;AACpBR,EAAAA,MAAM,CAACS,OAAP,CAAe;AACbC,IAAAA,IAAI,EAAE,QADO;AAEbC,IAAAA,KAAK,EAAE;AACLC,MAAAA,QAAQ,EAAEZ,MAAM,CAACa,YAAP,CAAoBC;AADzB;AAFM,GAAf;AAMD,CAPD;AASA;;;;;AAGA,IAAMC,QAAQ,GAAG,wBAAjB;AAEA;;;;;AAIA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,MAAD,EAASC,KAAT,EAAmB;AACrC;AACA,UAAQD,MAAR;AACE;AACA,SAAK,GAAL;AACET,MAAAA,OAAO;AACP;AACF;AACA;;AACA,SAAK,GAAL;AACEN,MAAAA,GAAG,CAAC,YAAD,CAAH;AACAiB,MAAAA,YAAY,CAACC,UAAb,CAAwB,OAAxB;AACAD,MAAAA,YAAY,CAACC,UAAb,CAAwB,MAAxB,EAHF,CAIE;;AACAC,MAAAA,UAAU,CAAC,YAAM;AACfb,QAAAA,OAAO;AACR,OAFS,EAEP,IAFO,CAAV;AAGA;AACF;;AACA,SAAK,GAAL;AACEN,MAAAA,GAAG,CAAC,UAAD,EAAY,OAAZ,CAAH;AACA;;AACF;AACEoB,MAAAA,OAAO,CAACC,GAAR,CAAYL,KAAZ;AArBJ;AAsBE,CAxBJ,C,CA0BA;;;AACA,IAAIM,QAAQ,GAAGzB,KAAK,CAAC0B,MAAN,CAAa;AAACC,EAAAA,OAAO,EAACX,QAAT;AAAkBY,EAAAA,OAAO,EAAE,OAAO;AAAlC,CAAb,CAAf,C,CACA;;AACAH,QAAQ,CAACI,QAAT,CAAkBC,OAAlB,CAA0BC,IAA1B,CAA+B,cAA/B,IAAiD,mCAAjD;AACA;;;;;AAIAN,QAAQ,CAACO,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CACE,UAAAC,MAAM,EAAI;AACR;AACA;AACA;AACA;AACA,MAAMC,KAAK,GAAGlC,KAAK,CAACmC,KAAN,CAAYD,KAA1B;AACAA,EAAAA,KAAK,KAAKD,MAAM,CAACL,OAAP,CAAeQ,aAAf,GAA+BF,KAApC,CAAL;AACA,SAAOD,MAAP;AACD,CATH,EAUE,UAAAI,KAAK;AAAA,SAAIC,OAAO,CAACD,KAAR,CAAcA,KAAd,CAAJ;AAAA,CAVP,E,CAYA;;AACAd,QAAQ,CAACO,YAAT,CAAsBS,QAAtB,CAA+BP,GAA/B,EACE;AACA,UAAAQ,GAAG;AAAA,SAAIA,GAAG,CAACxB,MAAJ,KAAe,GAAf,GAAqBsB,OAAO,CAACG,OAAR,CAAgBD,GAAG,CAACE,IAApB,CAArB,GAAiDJ,OAAO,CAACK,MAAR,CAAeH,GAAG,CAACE,IAAnB,CAArD;AAAA,CAFL,EAGE;AACA,UAAAL,KAAK,EAAI;AAAA,MACCE,QADD,GACcF,KADd,CACCE,QADD;;AAEP,MAAIA,QAAJ,EAAc;AACZ;AACAxB,IAAAA,WAAW,CAACwB,QAAQ,CAACvB,MAAV,EAAkBuB,QAAQ,CAACG,IAAT,CAAcrC,OAAhC,CAAX;AACA,WAAOiC,OAAO,CAACK,MAAR,CAAeJ,QAAf,CAAP;AACD,GAJD,MAIO;AACL;AACA;AACA;AACA;AACA,QAAI,CAACK,MAAM,CAACC,SAAP,CAAiBC,MAAtB,EAA8B,CAC5B;AACA;AACD,KAHD,MAGO;AACL,aAAOR,OAAO,CAACK,MAAR,CAAeN,KAAf,CAAP;AACD;AACF;AACF,CAtBH;AAwBA,eAAed,QAAf","sourcesContent":["/**\r\n * axios封装\r\n * 请求拦截、响应拦截、错误统一处理\r\n */\r\nimport axios from 'axios';\r\nimport router from '../router';\r\nimport store from '../store/index';\r\n\r\n/**\r\n * 提示函数\r\n */\r\nconst tip = (msg,type = 'info') => {\r\n  this.$message({\r\n    message: msg,\r\n    type: type,\r\n    duration: 1500\r\n  });\r\n}\r\n\r\n/**\r\n * 跳转登录页\r\n * 携带当前页面路由，以期在登录页面完成登录后返回当前页面\r\n */\r\nconst toLogin = () => {\r\n  router.replace({\r\n    path: '/login',\r\n    query: {\r\n      redirect: router.currentRoute.fullPath\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * 同一请求地址\r\n */\r\nconst BASE_URL = 'http://localhost:3000/';\r\n\r\n/**\r\n * 请求失败后的错误统一处理\r\n * @param {Number} status 请求失败的状态码\r\n */\r\nconst errorHandle = (status, other) => {\r\n  // 状态码判断\r\n  switch (status) {\r\n    // 401: 未登录状态，跳转登录页\r\n    case 401:\r\n      toLogin();\r\n      break;\r\n    // 403 token过期\r\n    // 清除token并跳转登录页\r\n    case 403:\r\n      tip('登录过期，请重新登录');\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n      // store.commit('logout', false);\r\n      setTimeout(() => {\r\n        toLogin();\r\n      }, 1000);\r\n      break;\r\n    // 404请求不存在\r\n    case 404:\r\n      tip('请求的资源不存在','error');\r\n      break;\r\n    default:\r\n      console.log(other);\r\n  }}\r\n\r\n// 创建axios实例\r\nvar instance = axios.create({baseURL:BASE_URL,timeout: 1000 * 12});\r\n// 设置post请求头\r\ninstance.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\r\n/**\r\n * 请求拦截器\r\n * 每次请求前，如果存在token则在请求头中携带token\r\n */\r\ninstance.interceptors.request.use(\r\n  config => {\r\n    // 登录流程控制中，根据本地是否存在token判断用户的登录情况\r\n    // 但是即使token存在，也有可能token是过期的，所以在每次的请求头中携带token\r\n    // 后台根据携带的token判断用户的登录情况，并返回给我们对应的状态码\r\n    // 而后我们可以在响应拦截器中，根据状态码进行一些统一的操作。\r\n    const token = store.state.token;\r\n    token && (config.headers.Authorization = token);\r\n    return config;\r\n  },\r\n  error => Promise.error(error))\r\n\r\n// 响应拦截器\r\ninstance.interceptors.response.use(\r\n  // 请求成功\r\n  res => res.status === 200 ? Promise.resolve(res.data) : Promise.reject(res.data),\r\n  // 请求失败\r\n  error => {\r\n    const { response } = error;\r\n    if (response) {\r\n      // 请求已发出，但是不在2xx的范围\r\n      errorHandle(response.status, response.data.message);\r\n      return Promise.reject(response);\r\n    } else {\r\n      // 处理断网的情况\r\n      // eg:请求超时或断网时，更新state的network状态\r\n      // network状态在app.vue中控制着一个全局的断网提示组件的显示隐藏\r\n      // 关于断网组件中的刷新重新获取数据，会在断网组件中说明\r\n      if (!window.navigator.onLine) {\r\n        // h5使用 pc忽略\r\n        // store.commit('changeNetwork', false);\r\n      } else {\r\n        return Promise.reject(error);\r\n      }\r\n    }\r\n  });\r\n\r\nexport default instance;\r\n"]}]}